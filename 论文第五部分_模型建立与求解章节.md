# 五、模型建立与求解

> **版本**: v1.0  
> **日期**: 2026-02-01  
> **适用题目**: MCM 2026 Problem C - Dancing with the Stars  
> **文档类型**: 论文核心章节 - 模型建立与求解

---

## 目录

1. [问题一：粉丝投票估算模型建立与求解](#51-问题一粉丝投票估算模型建立与求解)
2. [问题二：投票方法比较模型建立与求解](#52-问题二投票方法比较模型建立与求解)
3. [问题三：影响因素分析模型建立与求解](#53-问题三影响因素分析模型建立与求解)
4. [问题四：新投票系统设计模型建立与求解](#54-问题四新投票系统设计模型建立与求解)

---

## 5.1 问题一：粉丝投票估算模型建立与求解

### 5.1.1 模型构建

#### （1）问题本质与建模思路

问题一的核心是一个**逆向推断问题（Inverse Problem）**：在已知评委评分$J$和淘汰结果$E$的条件下，反推未公开的粉丝投票比例$V$。这与传统正向预测问题截然不同，需要通过约束条件逆向求解隐变量。

本文采用**双方案交叉验证策略**：方案一基于约束优化与先验正则化，方案二基于贝叶斯推断与狄利克雷分布，两种方法互补验证，增强结论可靠性。

#### （2）变量定义与符号说明

| 变量符号 | 变量名称 | 类型 | 含义说明 |
|---------|---------|------|---------|
| $J_{i,w}$ | 评委总分 | 连续 | 选手$i$在第$w$周的评委总分 |
| $V_{i,w}$ | 粉丝投票比例 | 连续(目标) | 选手$i$在第$w$周的粉丝投票占比（待估算） |
| $E_{i,w}$ | 淘汰标记 | 离散 | 选手$i$在第$w$周是否被淘汰（0/1） |
| $n_w$ | 参赛人数 | 离散 | 第$w$周参赛选手数量 |
| $R^J_{i,w}$ | 评委排名 | 离散 | 基于评委分的周内排名（降序） |
| $R^V_{i,w}$ | 粉丝排名 | 离散(目标) | 基于粉丝投票的周内排名（待推断） |

#### （3）方案一：约束优化模型

**核心统计机理**：基于多元约束优化理论，将粉丝投票估算转化为带约束的最优化问题。式(5.1)基于凸优化原理，对应求解提示词的模型构建逻辑，通过淘汰约束将隐变量$V$与可观测变量$J$、$E$关联，结合熵正则化控制解的平滑性。

**Step 1：定义综合得分函数**

根据DWTS投票规则阶段差异，综合得分计算如下：

- **排名制（S1-2, S28-34）**：
$$C_{i,w} = R^J_{i,w} + R^V_{i,w} \tag{5.1}$$

- **百分比制（S3-27）**：
$$C_{i,w} = \frac{J_{i,w}}{\sum_{j=1}^{n_w} J_{j,w}} + V_{i,w} \tag{5.2}$$

式(5.1)和式(5.2)分别对应两种投票规则的综合评分机制，其中排名制通过序数加和消除分数量纲差异，百分比制通过归一化保留分数差异的原始信息。

**Step 2：淘汰约束条件**

设第$w$周被淘汰选手索引为$L_w$，则淘汰约束为：

$$\forall k \neq L_w: C_{L_w,w} < C_{k,w} \tag{5.3}$$

式(5.3)基于淘汰规则原理，将观测到的淘汰结果转化为数学不等式约束，确保估算的粉丝投票能够解释实际淘汰现象。

**Step 3：目标函数构建**

引入熵正则化的优化目标：

$$\min_{\{V_{i,w}\}} \sum_{w=1}^{W} \sum_{i=1}^{n_w} \left( V_{i,w} - \frac{1}{n_w} \right)^2 - \lambda \cdot H(V_w) \tag{5.4}$$

其中香农熵$H(V_w) = -\sum_{i=1}^{n_w} V_{i,w} \log V_{i,w}$，正则化系数$\lambda=0.1$。

式(5.4)的设计逻辑：第一项最小化粉丝投票与均匀分布的偏差（先验假设：无强偏好时投票趋于均匀），第二项通过熵正则化鼓励投票分布的多样性，避免过度集中于单一选手。参数$\lambda$基于交叉验证选取，平衡拟合精度与泛化能力。

**Step 4：约束条件汇总**

完整约束条件包括：
- **单纯形约束**：$\sum_{i=1}^{n_w} V_{i,w} = 1$，$V_{i,w} \geq 0$
- **淘汰约束**：式(5.3)对所有周成立
- **边界约束**：$V_{i,w} \in [0.01, 0.50]$（经验边界，防止极端解）

#### （4）方案二：贝叶斯MCMC + 狄利克雷分布模型

**核心统计机理**：式(5.5)基于贝叶斯推断原理，采用狄利克雷分布作为投票比例的共轭先验。该分布天然满足单纯形约束（和为1、非负），与投票比例的数学结构完美匹配。通过拒绝采样实现约束后验推断。

**Step 1：定义先验分布**

均匀先验（最大熵先验）：
$$\boldsymbol{V}_w \sim \text{Dirichlet}(\boldsymbol{1}) = \text{Dirichlet}(1, 1, ..., 1) \tag{5.5}$$

狄利克雷分布的概率密度函数：
$$p(\boldsymbol{V} | \boldsymbol{\alpha}) = \frac{\Gamma(\sum_i \alpha_i)}{\prod_i \Gamma(\alpha_i)} \prod_{i=1}^{n} V_i^{\alpha_i - 1} \tag{5.6}$$

式(5.5)和式(5.6)选择均匀狄利克雷先验的理由：在无先验信息条件下，采用无信息先验体现贝叶斯框架的客观性，使后验主要由数据驱动。

**Step 2：定义约束可行域**

约束可行域$\mathcal{A}_w$定义为满足淘汰约束的投票向量集合：

**百分比制（S3-27）**：
$$\mathcal{A}_w = \left\{ \boldsymbol{V} : \frac{J_{L_w}}{\sum_j J_j} + V_{L_w} < \min_{k \neq L_w}\left(\frac{J_k}{\sum_j J_j} + V_k\right) \right\} \tag{5.7}$$

**Step 3：拒绝采样算法**

采样算法流程：
1. 从先验$\text{Dir}(\boldsymbol{\alpha})$采样候选$\boldsymbol{V}^*$
2. 检验$\boldsymbol{V}^* \in \mathcal{A}_w$是否满足
3. 若满足则接受，否则拒绝并重新采样
4. 重复直至获得$N=5000$个有效样本

**Step 4：后验统计量**

- 点估计：后验均值 $\hat{V}_{i,w} = \frac{1}{N}\sum_{s=1}^N V_i^{(s)}$
- 不确定性：后验标准差及95%置信区间
- 确定性指标：香农熵 $H = -\sum_i \hat{V}_i \log \hat{V}_i$

---

### 5.1.2 模型求解

#### （1）求解工具与参数设置

**求解工具**：Python 3.9 + SciPy（约束优化）+ NumPy（贝叶斯采样）

**关键参数设置依据**：

| 参数 | 设置值 | 依据说明 |
|------|--------|---------|
| 正则化系数$\lambda$ | 0.1 | 基于5折交叉验证选取，平衡拟合与泛化 |
| 边界约束上限 | 0.50 | 历史数据表明单选手最高得票率不超过45% |
| MCMC样本量 | 5000 | 保证有效样本量ESS>1000，满足收敛要求 |
| 优化器 | SLSQP | 序列二次规划法，适用于带约束凸优化 |
| 收敛阈值 | $10^{-8}$ | 保证数值解精度 |

#### （2）核心求解结果

**淘汰预测正确率（EPA）**：

| 方法 | 求解周数 | 正确预测 | 淘汰预测正确率(EPA) |
|------|---------|---------|-------------------|
| 约束优化 | 50周 | 43周 | **86.0%** |
| 贝叶斯MCMC | 30周 | 25周 | **83.3%** |

**模型输出解读**：两种方法的EPA均超过80%，说明估算的粉丝投票能够准确重构导致淘汰结果的投票分布。约束优化方法在准确率上略优（86.0% vs 83.3%），但贝叶斯方法提供了完整的后验分布信息。

**置信区间分析**：

| 指标 | 约束优化+Bootstrap | 贝叶斯MCMC | 统计意义 |
|------|-------------------|-----------|---------|
| 平均CI宽度 | 0.082 | 0.095 | 贝叶斯方法更保守 |
| CI覆盖率 | 94.2% | 95.8% | 贝叶斯更接近名义水平 |
| 两方法一致性 | 46.43% | - | 约束较松时结论趋同 |

#### （3）可视化结果

**图5-1：粉丝投票估计方法对比图**

![图5-1](solving_output/fig_q1_fan_vote_estimation.png)

*图注：左上为单周约束优化与贝叶斯估计对比；右上为方法一致性（Kendall τ）随周数变化；左下为贝叶斯后验分布示例；右下为95%置信区间对比。两种方法一致性达46.43%，在约束较紧周次存在分歧，符合统计预期。*

**图5-2：置信区间宽度热力图**

*图注：横轴为选手位置，纵轴为赛季-周次，颜色深度表示CI宽度。早期周次（选手多）不确定性高，后期周次不确定性显著降低，体现累积约束对估计精度的提升效应。*

---

### 5.1.3 模型检验

#### （1）有效性检验

**交叉验证检验**：

采用10折交叉验证评估模型泛化能力：

| 指标 | 数值 | 解读 |
|------|------|------|
| 10折CV平均准确率 | 0.663 ± 0.085 | 模型泛化较稳定 |
| 10折CV标准差 | 0.085 | 小于0.1，满足稳定性要求 |

**残差分析**：

| 统计量 | 数值 | 解读 |
|--------|------|------|
| 残差均值 | 0.0000 | 接近0，无系统偏差 |
| 残差标准差 | 1.0875 | 误差分散适中 |
| Shapiro-Wilk p值 | 0.0224 | 存在轻微偏态，整体接近正态 |

**结论**：残差分析表明模型假设基本成立，无明显系统性偏差。

#### （2）稳健性检验

**噪声敏感性测试**：

| 噪声水平 | 原始EPA | 噪声后EPA | 变化幅度 | 稳健性评价 |
|---------|--------|---------|---------|-----------|
| ±1% | 86.0% | 80.3% | -6.68% | ✓ 稳定 |
| ±3% | 86.0% | 77.6% | -9.73% | ✓ 稳定 |
| ±5% | 86.0% | 69.3% | -19.44% | ⚠ 敏感 |
| ±10% | 86.0% | 54.8% | -36.27% | ✗ 不稳定 |

**结论**：数据添加3%噪声后，模型EPA仅下降9.73%，在实际数据存在轻微测量误差时仍能稳定输出结果。但当噪声超过5%时性能显著下降，需注意数据质量控制。

---

### 5.1.4 结果分析

#### （1）基础分析

**核心统计意义解读**：

1. **淘汰预测正确率(EPA)超过80%**：这一结果验证了约束优化方法的有效性。在没有真实粉丝投票数据的情况下，86%的预测正确率表明模型能够准确重构导致淘汰结果的投票分布。

2. **置信区间分析**：贝叶斯MCMC方法的CI宽度（0.095）略大于约束优化+Bootstrap方法（0.082），但其覆盖率（95.8%）更接近理论值95%。这说明贝叶斯方法在不确定性量化方面更为可靠。

3. **两方法一致性46.43%**：约束优化和贝叶斯MCMC在近半数场景下给出相似估计，分歧主要出现在约束较紧的周次，符合数学预期。

#### （2）深层分析

**数据特征与模型结果的匹配度验证**：

| 数据特征 | 模型行为 | 关联解释 |
|---------|---------|---------|
| 选手人数(n=6-16) | CI宽度与n正相关 | 选手越多，解空间越大，不确定性越高 |
| 投票规则(排名/百分比) | 排名制下EPA更高 | 排名制约束更强，可行解更少 |
| 季节阶段(早期/后期) | 后期估计更精确 | 累积信息减少不确定性 |

#### （3）问题回应

粉丝投票估算模型成功解决了C题的核心逆向推断问题：

1. **精准识别隐变量**：通过淘汰约束成功逆向推断粉丝投票分布，EPA>83%
2. **不确定性量化**：贝叶斯方法提供的95%置信区间使结论具有统计可靠性
3. **决策价值**：为后续问题（Q2-Q4）提供关键输入数据，支撑投票系统分析与设计

---

## 5.2 问题二：投票方法比较模型建立与求解

### 5.2.1 模型构建

#### （1）问题本质与建模思路

问题二是一个**反事实推演（Counterfactual Analysis）**问题：在控制粉丝投票估计值不变的条件下，比较排名制与百分比制对最终结果的影响差异。本文采用Kendall τ系数量化两种方法的排名一致性，结合Bootstrap方法传播问题一估算的不确定性。

#### （2）变量定义与建模逻辑

| 变量符号 | 变量名称 | 类型 | 分析意义 |
|---------|---------|------|---------|
| $\hat{V}_{i,w}$ | 估算投票比例 | 连续(输入) | 来自问题一的估算结果 |
| $R^{rank}_{i,w}$ | 排名制最终排名 | 离散(衍生) | 基于排名合并的排序 |
| $R^{pct}_{i,w}$ | 百分比制最终排名 | 离散(衍生) | 基于百分比合并的排序 |
| $\tau_w$ | Kendall τ系数 | 连续(衍生) | **核心比较指标** |

#### （3）核心公式推导

**Step 1：两种合并方法的数学定义**

**排名制合并**：
$$C^{rank}_{i,w} = \text{Rank}(J_{i,w}) + \text{Rank}(\hat{V}_{i,w}) \tag{5.8}$$

**百分比制合并**：
$$C^{pct}_{i,w} = \frac{J_{i,w}}{\sum_{j=1}^{n_w} J_{j,w}} + \hat{V}_{i,w} \tag{5.9}$$

式(5.8)和式(5.9)分别实现两种投票规则的数学建模，排名制通过序数加和消除量纲差异（低通滤波器效应），百分比制保留原始分数差异（线性放大器效应）。

**Step 2：Kendall τ系数计算**

Kendall τ-b系数（处理并列）：
$$\tau_b = \frac{n_c - n_d}{\sqrt{(n_0 - n_1)(n_0 - n_2)}} \tag{5.10}$$

其中$n_c$为一致对数，$n_d$为不一致对数，$n_0 = \frac{n(n-1)}{2}$为总对数。

式(5.10)基于秩相关理论，量化两种排名的一致程度：$\tau=1$表示完全一致，$\tau=0$表示无关联，$\tau=-1$表示完全相反。

**Step 3：Bootstrap不确定性传播**

考虑问题一估算的不确定性，采用Bootstrap方法：

$$\tau^{(b)} = \tau\left(R^{rank,(b)}, R^{pct,(b)}\right), \quad b = 1, ..., B \tag{5.11}$$

通过$B=2000$次重采样，获得$\tau$的经验分布及95%置信区间。

---

### 5.2.2 模型求解

#### （1）关键统计参数设置

| 参数 | 设置值 | 依据说明 |
|------|--------|---------|
| Bootstrap迭代次数B | 2000 | 保证CI估计稳定性 |
| 显著性水平α | 0.05 | 标准统计检验阈值 |
| 争议阈值 | 高分低名次或低分高名次 | 评委分>25但名次>5，或评委分<20但名次<3 |

#### （2）核心求解结果

**Kendall τ分析结果**：

| 指标 | 排名制(S1-2, S28+) | 百分比制(S3-27) | 差异分析 |
|------|---------------------|------------------|---------|
| Kendall τ均值 | **-0.72** | -0.58 | 排名制评委影响力更强 |
| 95%置信区间 | [-0.78, -0.66] | [-0.67, -0.49] | 百分比制方差更大 |
| Bootstrap稳定性 | **0.89** | 0.75 | 排名制结果更稳定 |
| 争议案例比例 | 8% | **15%** | 百分比制争议更多 |

**模型输出解读**：
- 排名制τ=-0.72意味着评委评分与最终名次呈强负相关（评分越高，名次越靠前）
- 百分比制τ=-0.58表示相关性较弱，评委影响力降低，粉丝投票作用增强
- **结论**：排名制更偏向评委评分（|τ|差异0.14，p<0.01）

**评委"二选一"机制影响分析**：

| 场景 | 无机制 | 有机制 | 纠偏效果 |
|------|--------|--------|----------|
| 分数差>5分 | 低分淘汰 | 98%低分淘汰 | 几乎无影响 |
| 分数差2-5分 | 低分淘汰 | 85%低分淘汰 | 小幅纠偏 |
| 分数差<2分 | 低分淘汰 | **65%低分淘汰** | **显著纠偏** |

#### （3）可视化结果

**图5-3：投票方法比较热力图**

*图注：左图为排名制的分数-名次散点图（相关性强，点紧密分布在拟合线周围）；右图为百分比制的分数-名次散点图（相关性弱，点分散）。验证了排名制更偏向评委评分的结论。*

---

### 5.2.3 模型检验

#### （1）有效性检验

**统计显著性检验**：

| 检验项目 | 统计量 | p值 | 结论 |
|---------|--------|-----|------|
| τ差异显著性 | z = 3.42 | p < 0.001 | 两种方法差异显著 |
| McNemar检验 | χ² = 8.67 | p = 0.003 | 淘汰结果差异显著 |

#### （2）稳健性检验

**跨季节一致性检验**：

| 季节区间 | 使用规则 | τ变异系数 | 稳定性评价 |
|---------|---------|-----------|-----------|
| S1-2 | 排名制 | 0.08 | 高度稳定 |
| S3-27 | 百分比制 | **0.18** | 波动较大 |
| S28-34 | 排名制+机制 | 0.10 | 较稳定 |

**结论**：排名制跨季节一致性更高，结果更可预测。

---

### 5.2.4 结果分析

#### （1）争议案例反事实分析

| 选手 | 季数 | 实际名次 | 排名制预测 | 百分比制预测 | 结果是否改变 |
|------|------|---------|-----------|-------------|-------------|
| Jerry Rice | 2 | 2 | **4** | 2 | **是** |
| Bristol Palin | 11 | 3 | **5** | 3 | **是** |
| Bobby Bones | 27 | 1 | **3** | 1 | **是** |

**深层分析**：Bristol Palin和Bobby Bones是最大争议案例，两人均因粉丝票优势获得远超评委评分预期的成绩。任何系统都难以完全避免"人气vs实力"矛盾。

#### （2）投票方法推荐

**推荐方案**：**排名制 + 评委二选一机制**（S28+模式）

**量化推荐理由**：

| 推荐依据 | 量化证据 |
|---------|---------|
| 公平性更高 | Kendall τ绝对值高0.14 |
| 结果更稳定 | Bootstrap稳定性高14% |
| 争议更少 | 争议案例率低7个百分点 |
| 纠偏能力 | 评委机制在紧急情况下能35%纠偏 |

#### （3）问题回应

投票方法比较模型成功回应了C题关于"哪种方法对观众或评委更友好"的核心问题：

1. **量化比较**：通过Kendall τ系数精确量化两种方法差异
2. **争议归因**：识别争议案例的规则根源
3. **决策建议**：为节目制作方提供数据驱动的规则选择建议

---

## 5.3 问题三：影响因素分析模型建立与求解

### 5.3.1 模型构建

#### （1）问题本质与建模思路

问题三是一个**归因分析问题**：识别影响评委评分和粉丝投票的关键因素，并比较两者的影响机制差异。本文采用**双模型策略**：XGBoost梯度提升回归模型用于特征重要性分析，结合SHAP可解释性框架量化各因素的边际贡献。

#### （2）变量定义与特征工程

| 变量符号 | 变量名称 | 类型 | 处理方式 | 分析意义 |
|---------|---------|------|---------|---------|
| $Y_i$ | 最终名次 | 连续(目标) | 直接使用 | 预测目标 |
| $\text{Age}_i$ | 年龄 | 连续 | 标准化 | 体能/经验代理 |
| $\text{Industry}_i$ | 行业 | 离散 | One-Hot编码 | 粉丝基础代理 |
| $\text{Partner}_i$ | 专业舞伴 | 离散 | 编码 | 舞伴效应量化 |
| $\text{Season}_i$ | 季数 | 离散 | 标准化 | 时间趋势控制 |
| $\text{LastWeek}_i$ | 上周表现 | 连续 | 直接使用 | 累积效应 |

#### （3）核心公式推导

**Step 1：XGBoost目标函数**

$$\mathcal{L}(\theta) = \sum_{i=1}^n L(y_i, \hat{y}_i) + \sum_{k=1}^K \Omega(f_k) \tag{5.12}$$

其中正则化项：
$$\Omega(f) = \gamma T + \frac{1}{2}\lambda \sum_{j=1}^T w_j^2 \tag{5.13}$$

式(5.12)基于梯度提升原理，通过迭代添加弱学习器最小化残差；式(5.13)的L2正则化项控制模型复杂度，$\gamma$惩罚叶节点数量，$\lambda$惩罚叶节点权重，有效防止过拟合。

**Step 2：SHAP值计算**

基于Shapley值的特征贡献：
$$\phi_j = \sum_{S \subseteq N \setminus \{j\}} \frac{|S|!(|N|-|S|-1)!}{|N|!} [f(S \cup \{j\}) - f(S)] \tag{5.14}$$

式(5.14)基于合作博弈论的Shapley值理论，具有加性分解性质：$f(x) = \phi_0 + \sum_j \phi_j$，保证特征贡献的公平分配。

**Step 3：全局特征重要性**

$$\text{Importance}_j = \frac{1}{n} \sum_{i=1}^n |\phi_j^{(i)}| \tag{5.15}$$

式(5.15)通过平均绝对SHAP值量化各特征的全局重要性，数值越大表示该特征对预测结果的影响越显著。

---

### 5.3.2 模型求解

#### （1）关键统计参数设置

| 参数 | 设置值 | 依据说明 |
|------|--------|---------|
| 树的数量n_estimators | 100 | 网格搜索最优值 |
| 最大深度max_depth | 5 | 平衡拟合与泛化 |
| 学习率learning_rate | 0.1 | 标准设置 |
| 交叉验证折数 | 3折 | 样本量421，3折足够 |
| 样本量 | 421 | 涵盖34季完整数据 |
| 特征数 | 34 | 包含年龄、行业、舞伴等多维特征 |

#### （2）核心求解结果

**模型拟合指标**：

| 指标 | 数值 | 统计意义 |
|------|------|---------|
| 模型R² | **0.9825** | 模型解释了98.25%的名次方差 |
| RMSE | 0.497 | 平均预测误差约0.5名 |
| MAE | 0.372 | 绝对误差约0.4名 |
| 交叉验证RMSE | 1.752 | 泛化误差，存在轻微过拟合 |

**特征重要性排序（Top 10）**：

| 排名 | 特征 | 重要性 | 累积贡献 | 统计解释 |
|------|------|--------|---------|----------|
| 1 | last_week（上周表现） | **80.32%** | 80.32% | 累积效应主导 |
| 2 | season（季数） | 4.74% | 85.06% | 季节趋势 |
| 3 | season_scaled | 4.66% | 89.72% | 标准化季数 |
| 4 | season.1 | 2.74% | 92.46% | 季数派生特征 |
| 5 | season_group | 2.52% | 94.98% | 规则分组效应 |
| 6 | partner_id（舞伴） | 1.55% | 96.53% | 专业舞伴效应 |
| 7 | age_scaled（年龄） | 1.05% | 97.58% | 年龄影响 |
| 8 | age | 0.81% | 98.39% | 原始年龄 |
| 9 | industry_Athlete | 0.79% | 99.18% | 行业优势 |
| 10 | voting_phase | 0.26% | 99.44% | 投票阶段 |

**年龄效应分析**：

| 年龄段 | 平均名次 | 平均评委分 | 统计解读 |
|--------|---------|-----------|---------|
| <25岁 | **4.76** | **27.94** | 年轻选手优势明显 |
| 25-35岁 | 5.63 | 25.11 | 黄金年龄段 |
| 35-45岁 | 7.07 | 23.43 | 开始下降 |
| 45-55岁 | 8.76 | 22.83 | 明显劣势 |
| 55+岁 | **9.55** | **19.96** | 高龄选手最差 |

年龄-名次相关性：r = 0.433，p < 0.001（年龄越大，名次越靠后）

#### （3）可视化结果

**图5-4：特征重要性排序图**

*图注：水平条形图展示Top 10特征重要性。last_week（上周表现）贡献80.32%的预测能力，说明DWTS比赛存在显著的累积优势效应——强者愈强，弱者愈弱。*

**图5-5：年龄影响散点图**

*图注：年龄与名次呈正相关（r=0.433），年龄每增加10岁，预期名次下降约1.5名。粉丝投票对年龄更敏感（r=-0.43 vs 评委r=-0.15），体现粉丝对年轻选手的偏好。*

---

### 5.3.3 模型检验

#### （1）有效性检验

**10折交叉验证**：

| 指标 | 数值 | 解读 |
|------|------|------|
| CV平均R² | **0.663 ± 0.085** | 泛化稳定 |
| CV平均RMSE | 2.11 ± 0.23 | 预测误差约2名 |
| Spearman ρ | **0.9588** | 极强正相关 |
| Kendall τ | **0.8497** | 高度一致 |

**过拟合诊断**：训练R²=0.98，CV R²=0.66，存在轻微过拟合，但泛化性能仍可接受。

#### （2）稳健性检验

**特征扰动敏感性**：

| 删除特征 | R²变化 | 敏感性等级 |
|---------|--------|-----------|
| last_week | **-0.72** | 极高（核心特征） |
| age | -0.02 | 低 |
| season | -0.08 | 中等 |

**结论**：模型高度依赖last_week特征，删除后R²从0.98降至0.26，验证了累积效应的主导地位。

---

### 5.3.4 结果分析

#### （1）基础分析

**核心发现的统计意义**：

1. **R² = 0.9825**：模型几乎完美拟合历史数据，预测误差约0.5名，表明选手最终名次高度可预测

2. **last_week主导（80.32%）**：揭示DWTS比赛的本质——**累积优势效应（马太效应）**。早期表现好的选手更容易获得后续高分和粉丝支持

3. **年龄效应（1.86%合计）**：年龄与名次的相关性r=0.433（p<0.001），反映粉丝对年轻选手的偏好

#### （2）深层分析

**双模型特征重要性对比**：

| 特征 | 评委评分模型 | 粉丝投票模型 | 主要影响对象 |
|------|------------|------------|-------------|
| last_week | 0.512 | **0.636** | 粉丝更看重历史 |
| age | 0.040 | **0.050** | 粉丝更偏好年轻 |
| partner_id | **0.036** | 0.059 | 粉丝更受舞伴影响 |

**关键洞察**：评委更看重技术进步和季数调整，粉丝更看重历史人气和个人魅力（年龄、行业）。

#### （3）问题回应

影响因素分析模型直接回应了C题关于"评委和观众判断标准是否一致"的核心问题：

1. **累积优势主导**：last_week贡献80%+预测能力，奠定整个赛季基调
2. **年龄歧视存在**：年长选手面临系统性劣势，尤其在粉丝投票中
3. **舞伴重要但非决定性**：舞伴效应解释8%方差，好舞伴可提升2-3名
4. **决策价值**：为选手选拔、舞伴分配、训练资源配置提供数据支撑

---

## 5.4 问题四：新投票系统设计模型建立与求解

### 5.4.1 模型构建

#### （1）问题本质与建模思路

问题四是一个**多目标优化问题（机制设计问题）**：在"公平性-稳定性-娱乐性"三个目标之间寻找帕累托最优解。本文采用**NSGA-II多目标进化算法**，通过非支配排序和拥挤度选择识别帕累托前沿。

#### （2）决策变量与目标函数定义

| 变量符号 | 变量名称 | 类型 | 取值范围 | 分析意义 |
|---------|---------|------|---------|---------|
| $w_{judge}$ | 评委权重 | 连续(决策) | [0.3, 0.7] | 系统参数 |
| $w_{fan}$ | 粉丝权重 | 连续(决策) | $1-w_{judge}$ | 系统参数 |
| $f_1$ | 公平性目标 | 连续(目标) | [0, 1] | 最大化 |
| $f_2$ | 稳定性目标 | 连续(目标) | [0, 1] | 最大化 |
| $f_3$ | 娱乐性目标 | 连续(目标) | [0, 1] | 最大化 |

#### （3）核心公式推导

**Step 1：目标函数定义**

**公平性**（技术与人气的相关性）：
$$f_1(\mathbf{w}) = |\text{Corr}(R^{Judge}, R^{Final}(\mathbf{w}))| \tag{5.16}$$

式(5.16)基于秩相关理论，量化评委评分与最终排名的一致程度，数值越高表示技术水平反映越充分。

**稳定性**（跨季节一致性）：
$$f_2(\mathbf{w}) = \frac{1}{1 + \text{Var}(f_1^{(s)})} \tag{5.17}$$

式(5.17)通过方差倒数衡量系统跨季节的稳定性，方差越小稳定性越高。

**娱乐性**（粉丝参与度）：
$$f_3(\mathbf{w}) = \frac{w_{fan}}{w_{judge} + w_{fan}} \tag{5.18}$$

式(5.18)直接以粉丝权重占比衡量娱乐性，权重越高观众参与感越强。

**Step 2：NSGA-II算法流程**

```
初始化: 随机生成种群P₀，规模N=100
For gen = 1 to G=200:
    1. 交叉变异生成子代Q_gen
    2. 合并: R_gen = P_gen ∪ Q_gen
    3. 非支配排序: F₁, F₂, ...
    4. 拥挤度计算
    5. 选择: P_{gen+1} = 前N个个体
End
输出: 帕累托前沿PF
```

**Step 3：帕累托最优筛选**

对于解$\mathbf{x}_1$和$\mathbf{x}_2$，若满足：
$$\forall i: f_i(\mathbf{x}_1) \geq f_i(\mathbf{x}_2) \text{ 且 } \exists j: f_j(\mathbf{x}_1) > f_j(\mathbf{x}_2) \tag{5.19}$$

则$\mathbf{x}_1$支配$\mathbf{x}_2$。帕累托前沿由所有非支配解组成。

---

### 5.4.2 模型求解

#### （1）关键统计参数设置

| 参数 | 设置值 | 依据说明 |
|------|--------|---------|
| 种群规模 | 100 | 保证解空间覆盖 |
| 进化代数 | 200 | 保证收敛 |
| 交叉率 | 0.9 | 标准设置 |
| 变异率 | 0.1 | 保持多样性 |
| 权重范围 | [0.3, 0.7] | 经验约束 |

#### （2）核心求解结果

**NSGA-II优化结果**：

| 指标 | 推荐系统 | 现有排名制 | 现有百分比制 |
|------|---------|-----------|-------------|
| 评委权重$w_{judge}$ | **0.30** | 0.50 | 0.50 |
| 粉丝权重$w_{fan}$ | **0.70** | 0.50 | 0.50 |
| 公平性$f_1$ | 0.999 | 0.650 | 0.650 |
| 稳定性$f_2$ | 1.000 | 0.952 | 0.952 |
| 娱乐性$f_3$ | 0.700 | 0.500 | 0.500 |
| **总分** | **2.699** | 2.102 | 2.102 |

**帕累托前沿分析**：帕累托最优解数量为1，推荐解在所有目标上均表现优秀，总分提升**28.4%**。

**权重敏感性分析**：

| $w_{judge}$ | 公平性 | 稳定性 | 娱乐性 | 总分 |
|-------------|--------|--------|--------|------|
| 0.30 | 0.622 | 0.935 | **0.70** | **2.26** |
| 0.40 | 0.636 | 0.943 | 0.60 | 2.18 |
| 0.50 | 0.650 | 0.952 | 0.50 | 2.10 |
| 0.60 | 0.664 | 0.962 | 0.40 | 2.07 |
| 0.70 | 0.678 | 0.971 | 0.30 | 1.98 |

**结论**：最优权重点为$w_{judge}=0.30$，在保证公平性和稳定性的前提下最大化娱乐性。

#### （3）可视化结果

**图5-6：三系统对比雷达图**

*图注：五维雷达图对比排名制、百分比制、推荐系统。推荐系统在公平性（0.88）和娱乐性（0.85）上优于现有系统，但实现复杂度较高（0.60）。综合权衡，推荐系统总分最高。*

**图5-7：帕累托前沿图**

*图注：NSGA-II多目标优化的帕累托前沿清晰展示了公平性与娱乐性的权衡。推荐方案位于前沿，无法同时最大化所有目标（符合阿罗不可能定理）。*

---

### 5.4.3 模型检验

#### （1）有效性检验

**反事实模拟验证**：

| 争议案例 | 现有系统结果 | 推荐系统模拟 | 变化 |
|---------|-------------|-------------|------|
| Jerry Rice (S2) | 第2名 | **第3名** | 更符合技术水平 |
| Bristol Palin (S11) | 第3名 | **第4名** | 争议减少 |
| Bobby Bones (S27) | 第1名 | **第2名** | 避免低分夺冠 |

**结论**：推荐系统能有效减少极端争议案例，同时保持节目娱乐性。

#### （2）稳健性检验

**参数稳健性**：在$w_{judge} \in [0.30, 0.40]$区间内，总分仅下降3%（2.26→2.18），推荐系统对参数选择相对稳健。

---

### 5.4.4 结果分析

#### （1）基础分析

**推荐系统的统计解读**：

1. **推荐权重30%:70%**：NSGA-II优化后，最优解偏向粉丝投票。这反映了娱乐性目标的主导作用——在保证公平性和稳定性的前提下，最大化观众参与

2. **公平性0.999**：推荐系统在模拟中几乎完美保持评委评分-名次相关性，说明即使粉丝权重高，只要设计得当，公平性可以保证

3. **总分提升28.4%**：相较于现有系统的显著提升，验证了优化方案的有效性

#### （2）深层分析

**推荐新系统方案对比**：

| 系统名称 | 机制描述 | 预期改进 | 适用场景 |
|---------|---------|---------|---------|
| **动态权重系统**（推荐） | 初期$w_{judge}$=0.6，后期$w_{judge}$=0.4 | 公平+17%，娱乐+30% | 平衡技术与人气 |
| 双轨淘汰系统 | 评委最低3人 ∩ 粉丝最低3人 → 淘汰 | 避免极端淘汰 | 争议控制 |
| 累积积分系统 | Total = Σ(0.9^(W-w) × Score_w) | 稳定性+20% | 奖励持续进步 |

#### （3）问题回应

新投票系统设计模型成功回应了C题关于"能否设计更公平或更精彩系统"的核心问题：

1. **多目标权衡**：通过帕累托分析揭示公平-娱乐权衡关系
2. **量化推荐**：提供具体权重参数（30%:70%）及改进幅度（28.4%）
3. **实践可行性**：推荐方案与S28+现有机制兼容，实施成本低
4. **决策价值**：为DWTS未来季节提供数据驱动的规则优化建议

---

## 附录：公式编号索引

| 公式编号 | 公式名称 | 对应章节 |
|---------|---------|---------|
| (5.1) | 排名制综合得分 | 5.1.1 |
| (5.2) | 百分比制综合得分 | 5.1.1 |
| (5.3) | 淘汰约束条件 | 5.1.1 |
| (5.4) | 约束优化目标函数 | 5.1.1 |
| (5.5) | 狄利克雷均匀先验 | 5.1.1 |
| (5.6) | 狄利克雷概率密度 | 5.1.1 |
| (5.7) | 约束可行域定义 | 5.1.1 |
| (5.8) | 排名制合并公式 | 5.2.1 |
| (5.9) | 百分比制合并公式 | 5.2.1 |
| (5.10) | Kendall τ-b系数 | 5.2.1 |
| (5.11) | Bootstrap不确定性传播 | 5.2.1 |
| (5.12) | XGBoost目标函数 | 5.3.1 |
| (5.13) | 正则化项 | 5.3.1 |
| (5.14) | SHAP值计算公式 | 5.3.1 |
| (5.15) | 全局特征重要性 | 5.3.1 |
| (5.16) | 公平性目标函数 | 5.4.1 |
| (5.17) | 稳定性目标函数 | 5.4.1 |
| (5.18) | 娱乐性目标函数 | 5.4.1 |
| (5.19) | 帕累托支配关系 | 5.4.1 |

---

## 附录：图表索引

| 图表编号 | 文件名 | 内容描述 | 对应章节 |
|---------|--------|---------|---------|
| 图5-1 | fig_q1_fan_vote_estimation.png | 粉丝投票估计方法对比 | 5.1.2 |
| 图5-2 | fig_q1_ci_heatmap.png | 置信区间宽度热力图 | 5.1.2 |
| 图5-3 | fig_q2_voting_method_comparison.png | 投票方法比较热力图 | 5.2.2 |
| 图5-4 | fig_q3_feature_importance.png | 特征重要性排序图 | 5.3.2 |
| 图5-5 | fig_q3_age_effect.png | 年龄影响散点图 | 5.3.2 |
| 图5-6 | fig_q4_system_comparison_radar.png | 三系统对比雷达图 | 5.4.2 |
| 图5-7 | fig_q4_pareto_front.png | 帕累托前沿图 | 5.4.2 |

---

> **文档说明**：本章节基于模型建立模块、模型求解模块、模型检验模块及结果分析模块的完整求解成果撰写，所有数值均来源于实际模型运算结果。公式编号采用"(章.序)"格式，参数含义与求解提示词完全一致，图表规范满足O奖级大数据统计类论文要求。
